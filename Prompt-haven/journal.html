<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>PromptHaven — Journal</title>
<style>
  :root{--bg:#f6fafb;--fg:#0f172a;--card:#fff;--muted:#6b7280}
  body{margin:0;font-family:system-ui;background:var(--bg);color:var(--fg)}
  .wrap{max-width:900px;margin:0 auto;padding:16px}
  .card{background:var(--card);border-radius:14px;box-shadow:0 6px 18px rgba(0,0,0,.06);padding:20px;margin-bottom:12px}
  textarea{width:100%;min-height:160px;padding:12px;border:1px solid #e5e7eb;border-radius:10px}
  .btn{background:#111;color:#fff;padding:10px 14px;border-radius:10px;border:0;cursor:pointer}
  .muted{color:var(--muted);font-size:.9rem}
</style>
</head>
<body>
<div id="site-nav"></div>
<script src="nav.js"></script>

<div class="wrap" style="margin-top:18px">
  <div class="card">
    <h2>New entry</h2>
    <textarea id="entry" placeholder="Let your thoughts wander…"></textarea>
    <div style="text-align:right;margin-top:8px">
      <button class="btn" id="saveBtn">Save</button>
    </div>
    <p class="muted">Saves to your device (localStorage) for this demo.</p>
  </div>

  <div id="list"></div>
</div>

<script>
const key='pj_entries';
function load(){ return JSON.parse(localStorage.getItem(key)||'[]'); }
function saveAll(items){ localStorage.setItem(key, JSON.stringify(items)); }

function render(){
  const list=document.getElementById('list'); 
  list.innerHTML='';
  const items=load();
  if(!items.length){ 
    list.innerHTML='<div class="card muted">No entries yet. Your future self will be glad you started.</div>'; 
    return; 
  }
  items.forEach(e=>{
    const div=document.createElement('div');
    div.className='card';
    div.innerHTML = `
      <div style="font-size:.9rem;color:#6b7280">
        ${new Date(e.created_at).toLocaleString()}
      </div>
      ${e.prompt ? `<div class="muted" style="margin-top:4px">Prompt: ${e.prompt}</div>` : ''}
      <div style="white-space:pre-wrap;margin-top:6px">${e.content}</div>
      <div style="text-align:right;margin-top:8px">
        <button data-id="${e.id}" class="del" style="background:#fee2e2;color:#111;padding:8px 12px;border-radius:10px;border:0">Delete</button>
      </div>
    `;
    list.appendChild(div);
  });
  document.querySelectorAll('.del').forEach(b=>b.onclick=()=>{
    const id=b.getAttribute('data-id');
    const next=load().filter(x=>x.id!==id); 
    saveAll(next); 
    render();
  });
}

document.getElementById('saveBtn').onclick=()=>{
  const t=document.getElementById('entry');
  const v=t.value.trim(); 
  if(!v) return;
  const items=load();
  items.unshift({
    id:crypto.randomUUID(),
    content:v,
    created_at:new Date().toISOString(),
    prompt:"(No prompt — written from Journal page)"
  });
  saveAll(items); 
  t.value=''; 
  render();
  localStorage.setItem('pj_saved_today', new Date().toDateString());
};

render();
</script>
</body>
</html>
